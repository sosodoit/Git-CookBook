# 푸시하려 했는데 다른 브랜치에서 작업했을 때

작업 브랜치가 아닌 main(또는 master) 등 다른 브랜치에서 작업하고 커밋했을 때, 해당 커밋만 올바른 브랜치로 옮기는 방법입니다.

## 상황

- 의도한 기능 브랜치가 아닌 **main**에서 작업하고 `git commit`까지 해버린 경우
- **아직 `git push`는 하지 않은 상태**에서 고치는 방법을 안내합니다.

## 원칙

- 잘못 커밋한 **그 커밋**을 올바른 브랜치로 옮기고,
- main은 커밋하기 **이전 시점**으로 되돌립니다.

## 명령어 (아직 푸시하지 않았을 때)

**1. 현재 상태(잘못 커밋된 내용 포함)로 올바른 브랜치를 새로 만듭니다.**

```bash
git checkout -b 올바른브랜치명
```

- 이렇게 하면 “지금 커밋까지 포함한 상태”가 **올바른브랜치명**에 붙습니다.

**2. main으로 돌아가서 방금 커밋 하나를 취소합니다.**

```bash
git checkout main
git reset --hard HEAD~1
```

- `HEAD~1`: “한 단계 이전 커밋”으로 되돌립니다. main에는 잘못된 커밋이 없어집니다.

**3. 올바른 브랜치에서 계속 작업하고 푸시합니다.**

```bash
git checkout 올바른브랜치명
# 필요하면 추가 작업 후
git push -u origin 올바른브랜치명
```

## 커밋을 여러 개 했을 때

main에 잘못 올린 커밋이 **여러 개**라면, 되돌릴 커밋 수만큼 `HEAD~1`을 늘리거나, 되돌리고 싶은 시점의 해시를 씁니다.

```bash
git checkout main
git reset --hard HEAD~3
```

- 예: 최근 3개 커밋을 main에서 제거합니다.  
- 그 3개 커밋은 이미 **올바른브랜치명**에 있으므로, 해당 브랜치에서만 푸시하면 됩니다.

## 참고

- **이미 main에 푸시한 경우**에는 `git reset --hard` 후 `git push --force`가 필요해 협업에 영향을 줄 수 있습니다. 이때는 [메인에 잘못 푸시했을 때](잘못된-브랜치에서-푸시.md)를 참고하세요.
- 올바른 브랜치를 “새로 만들지 않고” 이미 있는 브랜치로 옮기려면, 해당 브랜치로 이동한 뒤 `git cherry-pick 커밋해시`로 커밋만 가져올 수 있습니다. 그 다음 main에서는 `git reset --hard HEAD~1`(또는 해당 개수만큼)으로 제거하면 됩니다.
